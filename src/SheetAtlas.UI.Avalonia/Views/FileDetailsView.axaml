<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:SheetAtlas.UI.Avalonia.ViewModels"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="400" d:DesignHeight="600"
             x:Class="SheetAtlas.UI.Avalonia.Views.FileDetailsView"
             x:DataType="vm:FileDetailsViewModel">

    <Design.DataContext>
        <vm:FileDetailsViewModel/>
    </Design.DataContext>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="12">
            <!-- Header -->
            <TextBlock Text="File Details" FontWeight="SemiBold" FontSize="16" Margin="0,0,0,12"/>

            <!-- Properties Table -->
            <ItemsControl ItemsSource="{Binding Properties}" Margin="0,0,0,16">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>

                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <StackPanel>
                            <!-- Header Row -->
                            <!--<Border BorderBrush="LightGray" BorderThickness="0,0,0,1"
                                    IsVisible="{Binding IsHeader}">
                                <TextBlock Text="{Binding Key}"
                                          FontWeight="SemiBold"
                                          Background="LightGray"
                                          Padding="8,4"
                                          FontSize="12"/>
                            </Border>-->

                            <!-- Separator Row (with optional action link) -->
                             <Border IsVisible="{Binding IsSeparator}"
                                    MinHeight="8"
                                    Padding="0,0,0,8"
                                    Margin="0"
                                    Background="#E0E0E0">
                                <!-- Show link if ActionCommand is present, otherwise empty -->

                                <Button Content="{Binding ActionText}"
                                       Command="{Binding ActionCommand}"
                                       HorizontalAlignment="Right"
                                       Background="Transparent"
                                       Foreground="#0066CC"
                                       Cursor="Hand"
                                       Padding="4,0,0,0"
                                       Margin="0,0,8,0"
                                       BorderThickness="0"
                                       IsVisible="{Binding ActionCommand, Converter={x:Static ObjectConverters.IsNotNull}}">
                                    <Button.Styles>
                                        <Style Selector="Button:pointerover">
                                            <Setter Property="Foreground" Value="#0052A3"/>
                                            <Setter Property="TextBlock.TextDecorations" Value="Underline"/>
                                        </Style>
                                    </Button.Styles>
                                </Button>
                            </Border>


                            <!-- Regular Property Row -->
                            <Grid IsVisible="{Binding IsRegularRow}" MinHeight="24">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="2"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Property Key -->
                                <Border Grid.Column="0"
                                        BorderBrush="DarkGray"
                                        BorderThickness="1,1,1,1"
                                        Background="#F0F0F0">
                                    <TextBlock Text="{Binding Key}"
                                              FontWeight="Bold"
                                              Padding="8,4"
                                              VerticalAlignment="Center"
                                              FontSize="12"
                                              Foreground="Black"/>
                                </Border>

                                <!-- Divider -->
                                <Border Grid.Column="1"
                                        Background="DarkGray"/>

                                <!-- Property Value -->
                                <Border Grid.Column="2"
                                        BorderBrush="DarkGray"
                                        BorderThickness="1,1,1,1"
                                        Background="White">
                                    <TextBlock Text="{Binding Value}"
                                              Padding="8,4"
                                              VerticalAlignment="Center"
                                              TextWrapping="Wrap"
                                              FontSize="12"
                                              Foreground="Black"/>
                                </Border>
                            </Grid>
                        </StackPanel>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- Empty State -->
            <TextBlock Text="Select a file from the list to view details"
                      FontStyle="Italic"
                      Foreground="Gray"
                      HorizontalAlignment="Center"
                      Margin="0,40,0,0"
                      IsVisible="{Binding SelectedFile, Converter={x:Static ObjectConverters.IsNull}}"/>
        </StackPanel>
    </ScrollViewer>
</UserControl>
